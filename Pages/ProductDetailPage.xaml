<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="ARMauiApp.Pages.ProductDetailPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:ARMauiApp.ViewModels"
             x:DataType="viewmodels:ProductDetailViewModel"
             Title="Product Details">

    <Grid>
        <!-- Main Content -->
        <ScrollView>
            <StackLayout Spacing="0">
            
            <!-- Product Image -->
            <Frame HeightRequest="300"
                   Padding="0"
                   CornerRadius="0"
                   HasShadow="False"
                   BackgroundColor="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray800}}">
                <Label Text="ðŸ“±"
                       FontSize="120"
                       VerticalOptions="Center"
                       HorizontalOptions="Center" />
            </Frame>

            <!-- Product Info -->
            <StackLayout Padding="20" Spacing="15">
                
                <!-- Product Name -->
                <Label Text="{Binding Product.Name, FallbackValue='Loading Product Name...'}"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light=Black, Dark=White}" />

                <!-- Price -->
                <Label Text="{Binding Product.Price, StringFormat='${0:F2}', FallbackValue='$0.00'}"
                       FontSize="20"
                       FontAttributes="Bold"
                       TextColor="{StaticResource Primary}" />

                <!-- Description -->
                <Label Text="{Binding Product.Description, FallbackValue='No description available'}"
                       FontSize="16"
                       TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}"
                       LineBreakMode="WordWrap" />

                <!-- Size Selection -->
                <StackLayout IsVisible="{Binding Product.Sizes.Count, Converter={StaticResource CountToBoolConverter}}"
                           Spacing="10">
                    <Label Text="Size:"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                    
                    <Picker ItemsSource="{Binding Product.Sizes}"
                            SelectedItem="{Binding SelectedSize}"
                            HeightRequest="45" />
                </StackLayout>

                <!-- Product Details Grid -->
                <Frame BackgroundColor="{AppThemeBinding Light={StaticResource Gray50}, Dark={StaticResource Gray800}}"
                       HasShadow="False"
                       CornerRadius="8"
                       Padding="15">
                    <Grid RowDefinitions="Auto, Auto, Auto" 
                          ColumnDefinitions="*, *"
                          RowSpacing="10"
                          ColumnSpacing="15">
                        
                        <Label Grid.Row="0" Grid.Column="0"
                               Text="Category:"
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                        <Label Grid.Row="0" Grid.Column="1"
                               Text="{Binding Product.CategoryId}"
                               TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                        
                        <Label Grid.Row="1" Grid.Column="0"
                               Text="Created:"
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                        <Label Grid.Row="1" Grid.Column="1"
                               Text="{Binding Product.CreatedAt, StringFormat='{0:MMM dd, yyyy}'}"
                               TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                        
                        <Label Grid.Row="2" Grid.Column="0"
                               Text="Status:"
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                        <Label Grid.Row="2" Grid.Column="1"
                               Text="{Binding Product.IsActive, Converter={StaticResource BoolToActiveStatusConverter}}"
                               TextColor="{Binding Product.IsActive, Converter={StaticResource BoolToStatusColorConverter}}" />
                        
                    </Grid>
                </Frame>

                <!-- Action Buttons -->
                <StackLayout Spacing="10" Margin="0,20,0,0">
                    
                    <Button Text="Add to Cart"
                            Command="{Binding AddToCartCommand}"
                            BackgroundColor="{StaticResource Primary}"
                            TextColor="White"
                            HeightRequest="50"
                            CornerRadius="25"
                            FontSize="18"
                            FontAttributes="Bold" />
                    
                    <Button Text="Back to Products"
                            Command="{Binding GoBackCommand}"
                            BackgroundColor="Transparent"
                            TextColor="{StaticResource Primary}"
                            BorderColor="{StaticResource Primary}"
                            BorderWidth="2"
                            HeightRequest="50"
                            CornerRadius="25"
                            FontSize="16" />
                    
                </StackLayout>

            </StackLayout>

        </StackLayout>
        </ScrollView>

        <!-- Loading Indicator Overlay -->
        <Grid IsVisible="{Binding IsLoading}"
              BackgroundColor="{AppThemeBinding Light=#80FFFFFF, Dark=#80000000}">
            <ActivityIndicator IsRunning="{Binding IsLoading}"
                              Color="{StaticResource Primary}"
                              VerticalOptions="Center"
                              HorizontalOptions="Center"
                              Scale="1.5" />
        </Grid>
    </Grid>

</ContentPage>
